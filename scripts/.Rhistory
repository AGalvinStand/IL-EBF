<<<<<<< Updated upstream
source("scripts/ebf_base_calc.R")
source("scripts/ebf_base_calc.R")
=======
# ADJUSTED OTR              - 15
# ADJUSTED_EAV              - 16
# REAL EAV CALC             - 17
# PTELL EAV CALC            - 18
# FY 21 BFM                 - 19
# clean --------------
# load il ebf raw data -  skip to row four. Referencing the FY22-EBF..xlsx
#                         to clean the column names
il_fy22_roe_li_data_raw <- read_excel("data/raw/FY22-EBF-Full-Calc-Revised.xlsx", sheet = 12,
skip = 4)
il_fy22_roe_li_data_raw <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY22-EBF-Full-Calc-Revised.xlsx", sheet = 12,
skip = 4)
View(il_fy22_roe_li_data_raw)
View(il_fy22_roe_li_data_raw)
# PURPOSE ---------
#   This script will clean ROE-LI Data and turn it into
#   a dataset for the EBF calculation.
# -------------
# PREPARED BY ------
# Chris Poulos
# 2022-07-26
# Let's go! - <('.' <)
#----------
# load ---------
options(scipen = 999)
library(tidyverse)
library(readxl)
# --------------
#       SHEET NAME          - SHEET NUMBER
#--------------------------------------------
# District Results Summary  - 1
# Base Calc                 - 2
# Control Variables         - 3
# Core Investments          - 4
# Per Student Investments   - 5
# Additional Investments    - 6
# Local Capacity Target     - 7
# Tier $                    - 8
# ENROLL-ALL                - 9
# ENROLL- LOW INCOME        - 10
# ENROLL - LI - ROE         - 11
#  ROE-LI Data              - 12
# ENROLL - EL               - 13
# REGION FACTOR             - 14
# ADJUSTED OTR              - 15
# ADJUSTED_EAV              - 16
# REAL EAV CALC             - 17
# PTELL EAV CALC            - 18
# FY 21 BFM                 - 19
# clean --------------
# load il ebf raw data -  skip to row four. Referencing the FY22-EBF..xlsx
#                         to clean the column names
il_fy22_roe_li_data_raw <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY22-EBF-Full-Calc-Revised.xlsx", sheet = 12,
skip = 4)
# fix column names
il_fy22_roe_li_data_raw <- il_fy22_roe_li_data_raw |>
# convert colnames to lowercase
rename_with(tolower)
# look at column names
names(il_fy22_roe_li_data_raw)
# new column names
new_names <- c("roenum",
"distid",  # Confirm that RCDT is district id
"distname",
"tot_ase",
"li_per",
"tot_li")
# manually replace column names
colnames(il_fy22_roe_li_data_raw) <- new_names
# look at column names now
names(il_fy22_roe_li_data_raw)
# look at district names - they are imported as characters!
glimpse(il_fy22_enroll_li_raw$distid)
il_fy22_roe_li_data_clean <- il_fy22_roe_li_data_raw
View(il_fy22_roe_li_data_clean)
# PURPOSE ---------
#   This script will clean ENROLL - EL and turn it into
#   a dataset for the EBF calculation.
# -------------
# PREPARED BY ------
# Chris Poulos
# 2022-07-26
# Vamos! - <('o' <)
#----------
# load ---------
options(scipen = 999)
library(tidyverse)
library(readxl)
# --------------
#             SHEET TABLE OF CONTENTS
#--------------------------------------------
#       SHEET NAME          - SHEET NUMBER
#--------------------------------------------
# District Results Summary  - 1
# Base Calc                 - 2
# Control Variables         - 3
# Core Investments          - 4
# Per Student Investments   - 5
# Additional Investments    - 6
# Local Capacity Target     - 7
# Tier $                    - 8
# ENROLL-ALL                - 9
# ENROLL- LOW INCOME        - 10
# ENROLL - LI - ROE         - 11
#  ROE-LI Data              - 12
# ENROLL - EL               - 13
# REGION FACTOR             - 14
# ADJUSTED OTR              - 15
# ADJUSTED_EAV              - 16
# REAL EAV CALC             - 17
# PTELL EAV CALC            - 18
# FY 21 BFM                 - 19
# clean --------------
# load il ebf raw data -  skip to row four. Referencing the FY22-EBF..xlsx
#                         to clean the column names
il_fy22_enroll_el_raw <- read_excel("data/raw/FY22-EBF-Full-Calc-Revised.xlsx", sheet = 13,
skip = 4)
il_fy22_enroll_el_raw <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/", sheet = 13,
skip = 4)
il_fy22_enroll_el_raw <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY22-EBF-Full-Calc-Revised.xlsx", sheet = 13,
skip = 4)
View(il_fy22_enroll_el_raw)
il_fy22_enroll_el_raw <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY22-EBF-Full-Calc-Revised.xlsx", sheet = 13,
skip = 4, n_max = 922)
View(il_fy22_enroll_el_raw)
View(il_fy22_enroll_el_raw)
il_fy22_enroll_el_raw <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY22-EBF-Full-Calc-Revised.xlsx", sheet = 13,
skip = 4)
il_fy22_enroll_el_raw <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY22-EBF-Full-Calc-Revised.xlsx", sheet = 13,
skip = 4, n_max = 922)
View(il_fy22_enroll_el_raw)
il_fy22_enroll_el_raw <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY22-EBF-Full-Calc-Revised.xlsx", sheet = 13,
skip = 4, n_max = 923)
View(il_fy22_enroll_li_clean)
# fix column names
il_fy22_enroll_el_raw <- il_fy22_enroll_el_raw |>
# convert colnames to lowercase
rename_with(tolower)
# look at column names
names(il_fy22_enroll_el_raw)
# new column names
# naming convention - delete# is the column number used to delete further
#                     down in the script
new_names <- c("distid",
"distname",  # Confirm that RCDT is district id
"el_2019",
"el_2020",
"el_2021",
"delete6",
"el_3yravg",
"delete8",
"el_final", # Final el count (greater of current year or 3 year average)
"selected")
# manually replace column names
colnames(il_fy22_enroll_el_raw) <- new_names
# look at column names now
names(il_fy22_enroll_el_raw)
# look at district names - they are imported as characters!
glimpse(il_fy22_enroll_li_raw$distid)
# delete unwanted columns
il_fy22_enroll_el_clean <- il_fy22_enroll_el_raw[,-c(6,8)]
View(il_fy22_enroll_el_clean)
# PURPOSE ---------
#   This script will clean ENROLL-ALL sheet and turn it into a
#   dataset for the EBF calculation.
# -------------
# PREPARED BY ------
# Chris Poulos
# 2022-07-26
# Let's go! - <('.' <)
#----------
# load ---------
options(scipen = 999)
library(tidyverse)
library(readxl)
# --------------
#       SHEET NAME          - SHEET NUMBER
#--------------------------------------------
# District Results Summary  - 1
# Base Calc                 - 2
# Control Variables         - 3
# Core Investments          - 4
# Per Student Investments   - 5
# Additional Investments    - 6
# Local Capacity Target     - 7
# Tier $                    - 8
# ENROLL-ALL                - 9
# ENROLL- LOW INCOME        - 10
# ENROLL - LI - ROE         - 11
#  ROE-LI Data              - 12
# ENROLL - EL               - 13
# REGION FACTOR             - 14
# ADJUSTED OTR              - 15
# ADJUSTED_EAV              - 16
# REAL EAV CALC             - 17
# PTELL EAV CALC            - 18
# FY 21 BFM                 - 19
# clean --------------
# load il ebf raw data -  skip to row four. Referencing the FY22-EBF..xlsx
#                         to clean the column names
il_fy23_dist_join <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY-23-Evidence-Based-Funding-Full-Calc.xlsx", sheet = 2,
skip = 10, n_max=927)
View(il_fy23_dist_join)
# PURPOSE ---------
#   This script will clean ENROLL-ALL sheet and turn it into a
#   dataset for the EBF calculation.
# -------------
# PREPARED BY ------
# Chris Poulos
# 2022-07-26
# Let's go! - <('.' <)
#----------
# load ---------
options(scipen = 999)
library(tidyverse)
library(readxl)
# --------------
#       SHEET NAME          - SHEET NUMBER
#--------------------------------------------
# District Results Summary  - 1
# Base Calc                 - 2
# Control Variables         - 3
# Core Investments          - 4
# Per Student Investments   - 5
# Additional Investments    - 6
# Local Capacity Target     - 7
# Tier $                    - 8
# ENROLL-ALL                - 9
# ENROLL- LOW INCOME        - 10
# ENROLL - LI - ROE         - 11
#  ROE-LI Data              - 12
# ENROLL - EL               - 13
# REGION FACTOR             - 14
# ADJUSTED OTR              - 15
# ADJUSTED_EAV              - 16
# REAL EAV CALC             - 17
# PTELL EAV CALC            - 18
# FY 21 BFM                 - 19
# clean --------------
# load il ebf raw data -  skip to row four. Referencing the FY22-EBF..xlsx
#                         to clean the column names
il_fy23_dist_join <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY-23-Evidence-Based-Funding-Full-Calc.xlsx", sheet = 2,
skip = 10, n_max=927)
# fix column names
il_fy23_dist_join |> il_fy23_dist_join
# PURPOSE ---------
#   This script will clean ENROLL-ALL sheet and turn it into a
#   dataset for the EBF calculation.
# -------------
# PREPARED BY ------
# Chris Poulos
# 2022-07-26
# Let's go! - <('.' <)
#----------
# load ---------
options(scipen = 999)
library(tidyverse)
library(readxl)
# --------------
#       SHEET NAME          - SHEET NUMBER
#--------------------------------------------
# District Results Summary  - 1
# Base Calc                 - 2
# Control Variables         - 3
# Core Investments          - 4
# Per Student Investments   - 5
# Additional Investments    - 6
# Local Capacity Target     - 7
# Tier $                    - 8
# ENROLL-ALL                - 9
# ENROLL- LOW INCOME        - 10
# ENROLL - LI - ROE         - 11
#  ROE-LI Data              - 12
# ENROLL - EL               - 13
# REGION FACTOR             - 14
# ADJUSTED OTR              - 15
# ADJUSTED_EAV              - 16
# REAL EAV CALC             - 17
# PTELL EAV CALC            - 18
# FY 21 BFM                 - 19
# clean --------------
# load il ebf raw data -  skip to row four. Referencing the FY22-EBF..xlsx
#                         to clean the column names
il_fy23_dist_join <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY-23-Evidence-Based-Funding-Full-Calc.xlsx", sheet = 2,
skip = 10, n_max=927)
# fix column names
il_fy23_dist_join <- il_fy23_dist_join |>
# convert colnames to lowercase
rename_with(tolower)
# look at column names
names(il_fy23_dist_join)
# create vector of new column names - include blank columns,
# rename these to delete1....N.
new_names <- c("distid",
"distname",
"county",
"orgtype")
# manually replace column names
colnames(il_fy23_dist_join) <- new_names
# look at column names now
names(il_fy23_dist_join)
# select only columns with data
# delete duplicate columns (at the end after "total") and
# delete the empty columns using command below. Tidyverse's
# mutate command (i.e. keep = c(selected columns) does not
# work when there are duplicate columns (the 3 columns at the
# end, 37-40).
il_fy23_dist_join <- il_fy23_dist_join[,-c(5:61)]
il_fy23_dist_join <- il_fy23_dist_join[,-c(5:48)]
View(il_fy23_dist_join)
# PURPOSE ---------
#   This script will perform the core investments calculations.
# -------------
# PREPARED BY ------
# Chris Poulos
# 2022-08-10
# Let's go! - <('.' <)
# load ---------
options(scipen = 999)
library(tidyverse)
library(readxl)
# CORE INVESTMENT STEPS --------
# CORE TEACHER AMOUNT------
# Bring in Low-income enrollment and control vairable dataframes.
source("01a_ebf_control_variables_clean.R")
getwd()
source("2023/01a_ebf_control_variables_clean.R")
source("2023/01c_ebf_enroll_li_clean.R")
# Extract class size variables (by grade category and low-income status)
li_k_3 <- as.numeric(il_fy23_cvs_core_class_size_clean$li[1])
nonli_k_3 <- as.numeric(il_fy23_cvs_core_class_size_clean$nonli[1])
li_4_12 <- as.numeric(il_fy23_cvs_core_class_size_clean$li[2])
nonli_4_12 <- as.numeric(il_fy23_cvs_core_class_size_clean$nonli[2])
# FTE core teachers to students by grade - taking into account income
ebf_core_investments <- il_fy23_enroll_li_clean |>
mutate(fte_coreteacher_k_3 = as.integer(((enroll_k_3_li/li_k_3)+(enroll_k_3_noli/nonli_k_3))*100)/100,
fte_coreteacher_4_8 = as.integer(((enroll_4_8_li/li_4_12)+(enroll_4_8_noli/nonli_4_12))*100)/100,
fte_coreteacher_9_12 = as.integer(((enroll_9_12_li/li_4_12)+(enroll_9_12_noli/nonli_4_12))*100)/100)
# Core teacher salary by grade
k8_coreteacher_salary <- as.numeric(il_fy23_cvs_avgsalary_clean$core_teacher[1])
hs_coreteacher_salary <- as.numeric(il_fy23_cvs_avgsalary_clean$core_teacher[2])
# Core teacher cost
ebf_core_investments <- ebf_core_investments |>
mutate(core_teacher_cost =
(fte_coreteacher_k_3*k8_coreteacher_salary)+
(fte_coreteacher_4_8*k8_coreteacher_salary)+
(fte_coreteacher_9_12*hs_coreteacher_salary))
# SPECIALIST TEACHER COST ----------
# Specialist Teacher % of Core Teacher
specialists_pk_5 <- il_fy23_cvs_core_investments_clean$specialists_per_of_coreteachers[1]
specialists_middle <- il_fy23_cvs_core_investments_clean$specialists_per_of_coreteachers[2]
specialists_hs <- il_fy23_cvs_core_investments_clean$specialists_per_of_coreteachers[3]
# Specialist teacher by grade
ebf_core_investments <- ebf_core_investments |>
mutate(fte_specialists =
as.integer(((specialists_pk_5*fte_coreteacher_k_3)+
(specialists_middle*fte_coreteacher_4_8)+
(specialists_hs*fte_coreteacher_9_12))*100)/100)
# Specialist teacher cost
ebf_core_investments <- ebf_core_investments |>
mutate(specialist_cost =
(specialists_pk_5*fte_coreteacher_k_3*k8_coreteacher_salary)+
(specialists_middle*fte_coreteacher_4_8*k8_coreteacher_salary)+
(specialists_hs*fte_coreteacher_9_12*hs_coreteacher_salary))
# INSTRUCTIONAL FACILITATOR COST -----------------
source("scripts/ebf_enroll_all_clean.R")
# INSTRUCTIONAL FACILITATOR COST -----------------
source("2023/01b_ebf_enroll_all_clean.R")
# Students for every 1 instructional facilitator by grade variable
instructional_facilitator_pk_5 <- il_fy23_cvs_core_investments_clean$instructional_facilitators[1]
instructional_facilitator_middle <- il_fy23_cvs_core_investments_clean$instructional_facilitators[2]
instructional_facilitator_hs <- il_fy23_cvs_core_investments_clean$instructional_facilitators[3]
# Join enrollment all tab data (to calculation FTE instructional facilitator by grade)
ebf_core_investments <- ebf_core_investments |>
left_join(il_fy23_enroll_all_clean, by = c("distid" = "distid"))
# Instructional facilitator by grade
ebf_core_investments <- ebf_core_investments |>
mutate(fte_instructional_facilitator_pk_5 =
as.integer((enroll_school_elem_pk_5/instructional_facilitator_pk_5)*100)/100,
fte_instructional_facilitator_middle =
as.integer((enroll_school_mid_6_8/instructional_facilitator_middle)*100)/100,
fte_instructional_facilitator_hs =
as.integer((enroll_school_hs_9_12/instructional_facilitator_hs)*100)/100)
# Instructional facilitator cost
ebf_core_investments <- ebf_core_investments |>
mutate(instructional_facilitator_cost =
(fte_instructional_facilitator_pk_5* k8_coreteacher_salary)+
(fte_instructional_facilitator_middle * k8_coreteacher_salary)+
(fte_instructional_facilitator_hs * hs_coreteacher_salary))
# CORE INTERVENTION TEACHER (Tutor) COST ---------
# Students for every 1 core intervention teacher by grade variable
core_intervention_pk_5 <- il_fy23_cvs_core_investments_clean$core_intervention_teacher[1]
core_intervention_middle <- il_fy23_cvs_core_investments_clean$core_intervention_teacher[2]
core_intervention_hs <- il_fy23_cvs_core_investments_clean$core_intervention_teacher[3]
# Core intervention teacher by grade
ebf_core_investments <- ebf_core_investments |>
mutate(fte_core_intervention_pk_5 =
as.integer((enroll_school_elem_pk_5/core_intervention_pk_5)*100)/100,
fte_core_intervention_middle =
as.integer((enroll_school_mid_6_8/core_intervention_middle)*100)/100,
fte_core_intervention_hs =
as.integer((enroll_school_hs_9_12/core_intervention_hs)*100)/100)
# Core intervention cost
ebf_core_investments <- ebf_core_investments |>
mutate(core_intervention_cost =
(fte_core_intervention_pk_5* k8_coreteacher_salary)+
(fte_core_intervention_middle * k8_coreteacher_salary)+
(fte_core_intervention_hs * hs_coreteacher_salary))
# GUIDANCE COUNSELOR COST ------------------------
# Students for every 1 guidance counselor by grade variable
guidance_counselor_pk_5 <- il_fy23_cvs_core_investments_clean$guidance_counselor[1]
guidance_counselor_middle <- il_fy23_cvs_core_investments_clean$guidance_counselor[2]
guidance_counselor_hs <- il_fy23_cvs_core_investments_clean$guidance_counselor[3]
# Guidance counselor salary by grade variable
k8_guidance_counselor_salary <- il_fy23_cvs_avgsalary_clean$guidance_counselor[1]
hs_guidance_counselor_salary <- il_fy23_cvs_avgsalary_clean$guidance_counselor[2]
# Guidance counselor by grade
ebf_core_investments <- ebf_core_investments |>
mutate(fte_guidance_counselor_pk_5 =
as.integer((enroll_school_elem_pk_5/guidance_counselor_pk_5)*100)/100,
fte_guidance_counselor_middle =
as.integer((enroll_school_mid_6_8/guidance_counselor_middle)*100)/100,
fte_guidance_counselor_hs =
as.integer((enroll_school_hs_9_12/guidance_counselor_hs)*100)/100)
# Guidance counselor cost
ebf_core_investments <- ebf_core_investments |>
mutate(guidance_counselor_cost =
(fte_guidance_counselor_pk_5* k8_guidance_counselor_salary)+
(fte_guidance_counselor_middle * k8_guidance_counselor_salary)+
(fte_guidance_counselor_hs * hs_guidance_counselor_salary))
# NURSE COST -------------------------------------
# Students for every 1 nurse by grade variable
school_nurse_pk_5 <- il_fy23_cvs_core_investments_clean$nurse[1]
school_nurse_middle <- il_fy23_cvs_core_investments_clean$nurse[2]
school_nurse_hs <- il_fy23_cvs_core_investments_clean$nurse[3]
# Nurse salary by grade
k8_school_nurse_salary <- il_fy23_cvs_avgsalary_clean$school_nurse[1]
hs_school_nurse_salary <- il_fy23_cvs_avgsalary_clean$school_nurse[2]
# Nurses per student by grade
ebf_core_investments <- ebf_core_investments |>
mutate(fte_school_nurse_pk_5 =
as.integer((enroll_school_elem_pk_5/school_nurse_pk_5)*100)/100,
fte_school_nurse_middle =
as.integer((enroll_school_mid_6_8/school_nurse_middle)*100)/100,
fte_school_nurse_hs =
as.integer((enroll_school_hs_9_12/school_nurse_hs)*100)/100)
# Nurse cost
ebf_core_investments <- ebf_core_investments |>
mutate(school_nurse_cost =
(fte_school_nurse_pk_5* k8_school_nurse_salary)+
(fte_school_nurse_middle * k8_school_nurse_salary)+
(fte_school_nurse_hs * hs_school_nurse_salary))
# SUBSTITUTE TEACHER COST ------------------------
ebf_core_investments <- ebf_core_investments |>
mutate(core_investment_teacher_positions =
fte_coreteacher_k_3+
fte_coreteacher_4_8+
fte_coreteacher_9_12+
fte_specialists+
fte_instructional_facilitator_pk_5+
fte_instructional_facilitator_middle+
fte_instructional_facilitator_hs+
fte_core_intervention_pk_5+
fte_core_intervention_middle+
fte_core_intervention_hs+
fte_school_nurse_pk_5+
fte_school_nurse_middle+
fte_school_nurse_hs)
source("scripts/ebf_additional_investments.R")
source("2023/03c_ebf_additional_investments.R")
# PURPOSE ---------
#   This script will calculate additional investments in the EBF formula.
# -------------
# PREPARED BY ------
# Ayesha Safdar
# 08-18-22
#----------
# load ---------
options(scipen = 999)
library(tidyverse)
library(readxl)
# AVERAGE SALARY VARIABLES --------
il_fy23_cvs_avgsalary_raw <- read_excel("C:/Users/jpacas/Documents/GitHub/IL-EBF/data/raw/FY-23-Evidence-Based-Funding-Full-Calc.xlsx", sheet = 3,
skip = 7,n_max = 4)
# fix column names
il_fy23_cvs_avgsalary_raw <- il_fy23_cvs_avgsalary_raw |>
# convert colnames to lowercase
rename_with(tolower)
# look at column names
names(il_fy23_cvs_avgsalary_raw)
# new column names
# naming convention - delete# is the column number used to delete further
#                     down in the script
new_names <- c("grade",
"guidance_counselor",
"school_psychologist",
"school_nurse",
"assistant_principal",
"core_teacher",
"social_worker",
"librarian_mediaspecialist",
"principal")
# manually replace column names
colnames(il_fy23_cvs_avgsalary_raw) <- new_names
# look at column names now
names(il_fy23_cvs_avgsalary_raw)
View(il_fy23_cvs_avgsalary_raw)
# clean district id data --------------
source("2023/02_ebf_dist_join_clean.R"))
source("2023/02_ebf_dist_join_clean.R")
source("2023/01a_ebf_control_variables_clean.R")
source("2023/01c_ebf_enroll_li_clean.R")
>>>>>>> Stashed changes
